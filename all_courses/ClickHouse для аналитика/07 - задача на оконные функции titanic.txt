Описание задачи:

Для таблицы Титаник посчитайте шансы выжить для каждого пользователя исходя из его пола и класса.

Формат ответа:

В качестве ответа впишите имя пассажира, у которого шанс выжить больше всего, отсортируйте по имени если таких пассажиров несколько [A -> Z]. Нельзя использовать JOIN. Только оконные функции.

------------------------------------------------------------------------
Моё решение:

Allen, Miss. Elisabeth Walton


SELECT Name FROM (
SELECT Name, 
AVG(Survived) OVER(PARTITION BY Sex,Pclass) AS chance
FROM titanic)
ORDER BY chance DESC, Name
LIMIT 1